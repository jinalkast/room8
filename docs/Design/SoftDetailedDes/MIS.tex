\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}

\author{\authname}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}p{4cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Members} & {\bf Notes}\\
\midrule
2025-01-17 & 0.0 & Team & Initial creation\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See SRS Documentation at \url{https://github.com/jinalkast/room8/blob/main/docs/SRS/SRS.pdf}

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specifications (MIS) for
\progname{}, a suite of tools for providing roommates in shared living situations tools to settle common disputes and keep track of shared responsibilities. Beginning from and following \hyperref[Start]{Section 7} the MIS for all modules in the \href{https://github.com/jinalkast/room8/tree/main/docs/Design/SoftArchitecture}{Module Guide} (MG) can be found. Potential readers of this document include new developers, and maintainers looking for clarity on the implementation of modules.\\

Complementary documents include the System Requirement Specifications
and Module Guide.  The full documentation and implementation can be
found at \url{https://github.com/jinalkast/room8/tree/main}.  

\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

{Hardware-Hiding} & ~ \\
\midrule

\multirow{7}{0.3\textwidth}{Behaviour-Hiding} & Input Parameters\\
& Output Format\\
& Output Verification\\
& Temperature ODEs\\
& Energy Equations\\ 
& Control Module\\
& Specification Parameters Module\\
\midrule

\multirow{3}{0.3\textwidth}{Software Decision} & {Sequence Data Structure}\\
& ODE Solver\\
& Plotting\\
\bottomrule

\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}

\newpage

% MIS of Sensor Reading Module

\section{MIS of Sensor Reading Module} \label{Start} 

\subsection{Module}

M1: SensorReadingModule

\subsection{Uses}
Used to gather data on user presence in shared space to determine when to take before and after pictures of the shared space.


\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
timeMotion & timesOfMotion & timeMotionDetected & - \\
detector & sensorData & motionPresent & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
  \item timesOfMotion: List[datetime] - List of time when motion was detected by the sensor.
\end{itemize}

\subsubsection{Environment Variables}
\begin{itemize}
  \item sensorData: sensorDataType - Data acquired by the sensor with data type supported by sensor.
\end{itemize}

\subsubsection{Assumptions}
None

\subsubsection{Access Routine Semantics}

\noindent timeMotion(timesOfMotion: datetime) $\rightarrow$ datetime:
\begin{itemize}
\item input: List of time stamps of when motion was detected. 
\item output: Last timestamp of when motion was detected. 
\end{itemize}

\noindent detector(sensorData: sensorDataType) $\rightarrow$ boolean:
\begin{itemize}
\item input: Data received from sensor. 
\item output: True or false value depending on if motion was detected. 
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
  \item insertTime(): Inserting time stamp into timesOfMotion variable.
\end{itemize}


\newpage

% MIS of Image Capture Module

\section{MIS of Image Capture Module} \label{Module} 

\subsection{Module}

M2: ImageCaptureModule

\subsection{Uses}
Capture image of shared space using camera system.

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
captureImage & - & image & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None

\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}
\begin{itemize}
\item captureImage will only be called when picture is needed to be taken, that is before user starts using shared space and five minutes after user has left shared space.
\end{itemize}


\subsubsection{Access Routine Semantics}

\noindent captureImage() $\rightarrow$ png:
\begin{itemize}
\item output: Image taken.
\end{itemize}


\subsubsection{Local Functions}
None

\newpage

% MIS of Image Upload Module

\section{MIS of Image Upload Module} \label{Module} 

\subsection{Module}

M3: ImageUploadModule

\subsection{Uses}
Uploads the captured image to Raspberry Pi for the cleanliness detection system to use for analysis.

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{3cm} p{3cm} p{5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
uploadImage & image & - & imgUploadErrorMessage \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None

\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}
\begin{itemize}
	\item Network is stable and never causes error in image upload.
	\item Power source is stable and never causes error in image upload.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent uploadImage(image: png):
\begin{itemize}
\item input: Image taken from camera. 
\item exception: ImageUploadInterrupted - Raised if error occurs during image upload.
\end{itemize}

\subsubsection{Local Functions}

None

\newpage


% MIS of Preprocessing Module

\section{MIS of Image Preprocessing Module} \label{Module} 

\subsection{Module}

M4: ImagePreprocessingModule

\subsection{Uses}
The ImagePreprocessingModule is used for preparing raw images (i.e. from the ImageUploadModule) to be submitted to subsequent modules (i.e. ObjectDetectionModule and ScoringModule). A series of transformations is applied to the image.

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
  \item SUPPORTED{\_}FORMATS: List[str] = ["JPEG", "PNG"]
  \item DEFAULT{\_}TRANSFORMS: torchvision.transforms.Compose\: A default set of PyTorch transformations, including resizing, normalization, and optional filtering
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
processImage & image: Image & Tensor & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None



\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}
\begin{itemize}
  \item The input image is in a valid format supported by PyTorch (e.g. JPEG, PNG)
  \item PyTorch and torchvision libraries are installed and functional
  \item Network connectivity is stable for receiving images through the cloud network
\end{itemize}


\subsubsection{Access Routine Semantics}

\noindent processImage(image: Image):
\begin{itemize}
\item transition: Applies a sequence of PyTorch transformations to the input image 
\item output: Returns the transformed image as a Pytorch tensor, ready for subsequent object detection
\item exception: 
\begin{itemize}
  \item InvalidImageFormatException: Raised if the input image format is unsupported
  \item TransformationError: Raised if an error occurs during transformations
\end{itemize}

\end{itemize}
\noindent procesImage(image: Image):
\begin{itemize}
  \item transition: Applies pixel map transformations (e.g. resizing, cropping, filtering) to the input image
  \item output: Returns the transformed image
  \item exception: 
  \begin{itemize}
    \item TransformationError: Raised if an error occurs during transformations
  \end{itemize}
  
  \end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
  \item validateImageFormat(image: Image) $\rightarrow$ bool: Checks if the input image format is supported
  \item creatTransforms() $\rightarrow$ torchvision.transforms.Compose\: Creates a PyTorch Compose object for the default set of transformations
  \item applyTransforms(image: Image, transforms: torchvision.transforms.Compose) $\rightarrow$ Tensor: Applies the given transformations to the input image
\end{itemize}

\newpage

\section{MIS of Object Detection Module} \label{Module} 

\subsection{Module}

M5: ObjectDetectionModule

\subsection{Uses}
To detect objects in an input tensor (preprocessed image) using a pretrained object detector (e.g. Faster R-CNN ResNet-50 FPN model). The output is a list of detected objects, where each object is represented as a HouseObject.

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
  \item MODEL{\_}NAME: str = "FasterRCNNResNet50FPN"
  \item CONFIDENCE{\_}THRESHOLD: float = 0.5 (minimum confidence score for object detection results)
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
detectObjects & inputTensor: Tensor & List[HouseObject] & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
	\item self.model: torchvision.models.detection.FasterRCNN
\end{itemize}


\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}
\begin{itemize}
  \item The input tensor is correctly preprocessed and normalized according to the requirements of the Faster R-CNN model
  \item PyTorch and torchvision libraries are installed and functional
\end{itemize}


\subsubsection{Access Routine Semantics}

\noindent detectObjects():
\begin{itemize}
\item transition: Uses the pretrained Faster R-CNN model to detect objects in the input tensor, filters results based on the confidence threshold
\item output: Returns a list of detected objects, where each object is represented as a HouseObject
\item exception: 
\begin{itemize}
  \item ModelNotLoadedException: Raised if the model fails to load
  \item DetectionError: Raised if an error occurs during detection process
\end{itemize}

\end{itemize}


\subsubsection{Local Functions}

\begin{itemize}
  \item loadModel() $\rightarrow$ torchvision.models.detection.FasterRCNN: Loads pretrained Faster R-CNN ResNet-50 FPN model
  \item filterDetections(detections: List[Dict], threshold: float) $\rightarrow$ List[HouseObject]: Filters the raw detections based on the confidence threshold and converts them to HouseObject instances
\end{itemize}

\newpage
 


\section{MIS of Scoring Module} \label{Module} 

\subsection{Module}

M6: ScoringModule

\subsection{Uses}
To evaluate changes in a room by comparing two sets of detected objects (representing "before" and "after" states) and assign a cleanliness score based on the differences

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
  \item MAX{\_}SCORE: int = 100 (maximum cleanliness score)
  \item MIN{\_}SCORE: int = 0 (minimum cleanliness score)
  \item OBJECT{\_}WEIGHTS: dict (Weights for scoring different objects based on their categories)
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{5cm} p{3cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
calculateCleanliness & before: List[HouseObject], after: List[HouseObject] & int & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None

\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}
\begin{itemize}
  \item Input lists 'before' and 'after' contain valid HouseObject instances
  \item The HouseObject class provides sufficient information (e.g., label, confidence, bounding box) to compare objects between the two states
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent calculateCleanliness():
\begin{itemize}
\item transition: Compares the before and after lists to identify added, removed, or moved objects; computes a cleanliness score based on these changes
\item output: Returns an integer cleanliness score between MIN{\_}SCORE and MAX{\_}SCORE
\item exception: 
\begin{itemize}
  \item ModelNotLoadedException: Raised if the model fails to load
  \item DetectionError: ScoringError: Raised if an error occurs during the scoring process
\end{itemize}

\end{itemize}


\subsubsection{Local Functions}

\begin{itemize}
  \item compareObjects(before: List[HouseObject], after: List[HouseObject]) $\rightarrow$ Dict[str, List[HouseObject]]: Identifies added, removed, and moved objects between the two lists
  \item computeScore(changes: Dict[str, List[HouseObject]]) $\rightarrow$ int: Computes the cleanliness score based on detected changes
\end{itemize}

\newpage
\section{MIS of Request Listener Module} \label{Module} 

\subsection{Module}

M7: Request Listener Module.

\subsection{Uses}
Exposes cleanliness detector to camera and image by making it an application programming interface.

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
getImages & - & images & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None

\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}
None

\subsubsection{Access Routine Semantics}

\noindent getImages() $\rightarrow$ List[png]:
\begin{itemize}
\item output: Two most recent images where one is the before and other is the after state of shared space after user is finished.
\end{itemize}

\subsubsection{Local Functions}
None

\newpage

\section{MIS of Data Uploading Module} \label{Module} 

\subsection{Module}

M8: DataUploadingModule

\subsection{Uses}
To provide an interface for the app's backend to interact with the Python-based object detection, machine learning, and scoring functionalities. The module packages these functionalities using FastAPI and exposes them as RESTful endpoints.

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
  \item API{\_}VERSION: str = "v1"
  \item BASE{\_}URL: str = "/api/v1"
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{5cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
startServer & - & None & - \\
\hline
POST /processImages & imageSet: JSON & cleanlinessScore: JSON & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
None


\subsubsection{Environment Variables}
\begin{itemize}
  \item FastAPI: Required for exposing RESTful endpoints
  \item Backend: The JavaScript backend that interacts with the module
\end{itemize}

\subsubsection{Assumptions}
\begin{itemize}
  \item FastAPI and its dependencies (e.g., Uvicorn) are installed and properly configured
  \item The backend sends valid JSON requests with correctly encoded image data
\end{itemize}


\subsubsection{Access Routine Semantics}

\noindent startServer():
\begin{itemize}
\item transition: Initiates the FastAPI application and starts the server to handle incoming requests
\item output: None
\item exception: 
\begin{itemize}
  \item ServerError: Raised if the server fails to start
\end{itemize}

\end{itemize}

\noindent Endpoint: POST /processImages
\begin{itemize}
\item transition:
\begin{itemize}
  \item Decodes the base64-encoded input images
  \item Passes the images through the ObjectDetectionModule and ScoringModule
  \item Computes and returns the cleanliness score
\end{itemize}
\item output: A JSON object with the following structure: \\ \{ \\"cleanliness{\_}score": int\\ \}
\item exception: 
\begin{itemize}
  \item InvalidInputError: Raised if the input JSON is malformed or invalid
  \item ProcessingError: Raised if an error occurs during processing
\end{itemize}

\end{itemize}


\subsubsection{Local Functions}

\begin{itemize}
  \item decodeImages(encodedImages: List[str]) $\rightarrow$ List[Tensor]: Decodes base64-encoded images into PyTorch tensors
  \item processRequest(images: List[Tensor]) $\rightarrow$ int: Processes the input images through the ObjectDetection and Scoring modules to compute the cleanliness score
\end{itemize}

\newpage

% MIS of Chore Schedule Module

\section{MIS of Chore Scheduling Module} \label{Module} 

\subsection{Module}

M9: ChoreSchedulingModule

\subsection{Uses}
The Chore Scheduling Module is used to assist roommates in scheduling chores. It provides a list of chores to be done and allows roommates to assign chores to each other. The module is in charge of schedule's database table, management of schedule instances, the application programming interface of the scheduling functions, and the implenentation to the frontend application. 

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{3cm} p{5cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
getHouseSchedule & string: houseID & JSON: houseScheduleObject & JSON: errorObject \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
  \item houseSchedule: JSON - A JSON object containing the current house's schedule
  \item selectedRoommate: string - The roommate selected to view schedule
\end{itemize}

\subsubsection{Environment Variables}
None

\subsubsection{Assumptions}

\begin{itemize}
  \item The houseScheduleObject is a valid JSON object that corresponds to the house's schedule
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent getHouseSchedule(string: houseID) $\rightarrow$ JSON:
\begin{itemize}
\item output: Returns the house schedule object for the specified houseID containing the schedule for all roommates
\item exception: Raises an exception if the houseID is invalid or if the house schedule object is not found
\end{itemize}


\subsubsection{Local Functions}

\begin{itemize}
  \item getRoommateHouseSchedule(JSON: houseScheduleObject, string: roommateID) $\rightarrow$ JSON: Returns the schedule for the specified roommate
  \item updateChore(string: houseID, string: choreID, JSON: newChore) $\rightarrow$ JSON: Updates the house schedule with the new chore for the specified previous chore
  \item createChore(string: houseID, JSON: newChore): Creates a new house chore object inside of the house schedule
  \item deleteChore(string: houseID, string: choreID) $\rightarrow$ JSON: Deletes the specified chore from the house schedule

\end{itemize}

\newpage
\section{MIS of Chat Bot Module} \label{Module}
 
\subsection{Module}

M10: ChatBotModule

\subsection{Uses}

The Chat Bot Module interfaces with an SMS API to facilitate group messaging functionality. It allows users to view the current group SMS status for the house, create a group, and send messages. The module implements logic for sending relevant notifications.

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{3cm} p{5cm} p{3cm} p{5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
createGroup & groupName: str, members: List[str] & GroupID: str & InvalidGroupException \\
\hline
sendMessage & groupID: str, message: str & bool & MessageDeliveryException \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{Environment Variables}

\begin{itemize}
\item SMS\_API\_KEY: key required to interface with the API which sends the SMS messages to the group.
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
  \item The SMS API is operational and has sufficient credits for sending messages.
  \item The provided phone numbers of all users in the house/group are valid.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent createGroup(groupName: str, members: List[str]):
\begin{itemize}
\item transition: Adds a new group to `activeGroups` with the specified members.
\item output: Returns a unique group ID for the newly created group.
\item exception: InvalidGroupException - Raised if the group exceeds the maximum allowed size or has invalid member details.
\end{itemize}

\noindent sendMessage(groupID: str, message: str):
\begin{itemize}
\item transition: Sends the message to all members of the specified group via the SMS API.
\item output: Returns `true` if the message is successfully sent, otherwise `false`.
\item exception: MessageDeliveryException - Raised if the message fails to deliver due to API issues or invalid group ID.
\end{itemize}


\subsubsection{Local Functions}

\begin{itemize}
  \item validatePhoneNumber(phone: str) $\rightarrow$ bool: Ensures the phone number follows the correct format.
  \item generateGroupID(groupName: str) $\rightarrow$ str: Generates a unique group ID based on the group name and timestamp.
  \item sendViaSms(phone: str, message: str) $\rightarrow$ bool: Sends a message to a specified phone number using the SMS API.
\end{itemize}

\newpage

% MIS of User Authentication Module

\section{MIS of User Authentication Module} \label{Module} 

\subsection{Module}

M12: UserAuthenticationModule

\subsection{Uses}

The User Authentication Module is used to authenticate users and manage user accounts. It provides a secure way for users to log in and access the application. The module is in charge of the user's database table, management of user instances, the application programming interface of the authentication functions, and the implementation to the frontend application.

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
  \item SUPPORTED{\_}AUTHENTICATION{\_}METHODS: List[str] = ["Google"]
  \item SUPPORTED{\_}AUTHENTICATION{\_}PROVIDERS: List[str] = ["OAuth2"]
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{5cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
getUser & string: jwtCookie & JSON: userObject & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
  \item activeJWT: datetime - The current accepted web token timing for user authentication
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
  \item UserDatabaseModule: Module from which user data is retrieved
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
  \item Google authentication service is always available and not down.
  \item The user has a valid Google email account for authentication.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent getUser(jwtCookie: string) $\rightarrow$ JSON:
\begin{itemize}
\item transition: Validates the JWT cookie and retrieves the corresponding user data from the UserDatabase.
\item output: Returns the userObject containing user details.
\item exception: 
  \begin{itemize}
    \item InvalidJWTException: Raised if the JWT cookie is invalid or expired.
    \item UserNotFoundException: Raised if no user is found for the given JWT cookie.
  \end{itemize}
\end{itemize}


\subsubsection{Local Functions}

\begin{itemize}
  \item validateJWT(jwt: string) $\rightarrow$ bool: Validates the given JWT token and returns true if valid, false otherwise.
  \item generateJWT(userID: string) $\rightarrow$ string: Generates a new JWT token for the given user ID.
  \item signInWithGAuth(authCode: string) $\rightarrow$ JSON: Authenticates the user using Google OAuth and returns user details.
  \item deleteJWT(jwt: string) $\rightarrow$ bool: Deletes the given JWT token and returns true if successful, false otherwise.
\end{itemize}

\newpage

% MIS of Home Management Module

\section{MIS of Home Management Module} \label{Module} 

\subsection{Module}

M13: HomeManagementModule

\subsection{Uses}

The Home Management Module is used to manage house-related operations such as adding, deleting, editing, joining, and leaving a house. It provides a way for users to manage their house and roommates within the application. The module is in charge of the house's database table, management of house instances, the application programming interface of the house management functions, and the implementation to the frontend application.

\subsection{Syntax}

\subsubsection{Exported Access Programs}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{3cm} p{4cm} p{5cm} p{3.5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
getRoommates & string: houseID & JSON: roommateList & JSON: errorObject \\
getHouseID & string: userID & string: houseID & JSON: errorObject \\
getHouseMetadata & string: houseID & JSON: houseMetadata & JSON: errorObject \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
  \item houseList: List[JSON] - The list of houses managed by the module
  \item roommateList: List[JSON] - The list of roommates for the specified house
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
  \item HomeDatabaseModule: Module from which house data is retrieved and stored
\end{itemize}

\subsubsection{Assumptions}
None

\subsubsection{Access Routine Semantics}

\noindent getRoommates(houseID: string) $\rightarrow$ JSON:
\begin{itemize}
\item output: Returns the list of roommates for the specified houseID.
\item exception: HouseNotFoundError: Raised if the houseID does not exist.
\end{itemize}

\noindent getHouseID(userID: string) $\rightarrow$ string:
\begin{itemize}
\item output: Returns the houseID that the user with the specified userID belongs to.
\item exception: UserNotFoundError: Raised if the userID does not exist.
\end{itemize}

\noindent getHouseMetadata(houseID: string) $\rightarrow$ JSON:
\begin{itemize}
\item output: Returns the metadata for the specified houseID.
\item exception: HouseNotFoundError: Raised if the houseID does not exist.
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
  \item addHouse(houseData: JSON) $\rightarrow$ JSON: Adds a new house to the HouseDatabase and returns the created house object.
  \item deleteHouse(houseID: string) $\rightarrow$ JSON: Deletes the specified house from the HouseDatabase and returns a confirmation message.
  \item editHouse(houseID: string, houseData: JSON) $\rightarrow$ JSON: Edits the details of the specified house in the HouseDatabase and returns the updated house object.
  \item joinHouse(userID: string, houseID: string) $\rightarrow$ JSON: Adds the user to the specified house and returns a confirmation message.
  \item leaveHouse(userID: string, houseID: string) $\rightarrow$ JSON: Removes the user from the specified house and returns a confirmation message.
  \item checkHouseExists(houseID: string) $\rightarrow$ bool: Checks if a house with the specified houseID exists in the HouseDatabase.
  \item checkUserExists(userID: string) $\rightarrow$ bool: Checks if a user with the specified userID exists in the UserDatabase.
  \item updateHouseList(): Updates the houseList state variable with the latest data from the HouseDatabase.
\end{itemize}

\newpage{}

\section*{Appendix --- Reflection}

The information in this section will be used to evaluate the team members on the
graduate attribute of Problem Analysis and Design.

\input{../../Reflection.tex}

\begin{enumerate}
  \item \textbf{What went well while writing this deliverable?}\\
  When writing this deliverable, the team addressed and resolved questions about our project that we had been putting off for a long time. Decisions such as "how \textit{exactly} will we be implementing this" were answered, and now the team is fully aligned on how each module will interact. Another thing that went well when writing this deliverable was that, unlike previous deliverables, there were no conflicts or issues raised because of past deliverables. This is because the team went back and modified past deliverables to check that all deliverables were in line with each other and wouldn't cause obstacles in the future.
  \item \textbf{What pain points did you experience during this deliverable, and how
    did you resolve them?}\\
    Some pain points when writing this deliverable included a lack of clarity about specific solution details and uncertainty about the granularity of modules. When writing the MG and the MIS, the team was still unclear about the exact outputs of the cleanliness detection algorithm. While working on the document, the team was unsure if we would implement advanced functionality like detecting stains and which user created them or if we would fall back to more basic functionality. Additionally, the team was unclear if we should include modules not implemented by us completely, such as authentication frameworks, databases, web frameworks, and programming languages. The lack of clarity about the cleanliness detection algorithm, while not completely resolved, was handled by specifying our unknowns in the anticipated changes section of our module guide and creating clear pathways for development based on what happens in the future. Additionally, we decided not to pursue one of our ideas due to privacy and other concerns raised by our project supervisor. The clarity issues about the document itself were rectified by communicating with our TA, including more modules, and distinguishing modules that were not implemented but used in the MG.      
  \item \textbf{Which of your design decisions stemmed from speaking to your client(s)
  or a proxy (e.g. your peers, stakeholders, potential users)? For those that
  were not, why, and where did they come from?}\\
  Almost all decisions stemmed from speaking to client(s) or a proxy. Our proxy for design decisions related to the cleanliness management system and all related systems is Dr. Tharmarasa, an expert in computer vision and object detection. Decisions related to the features of the client-facing application come from discussions with students in shared-living situations which are abundant at McMaster University.
  \item \textbf{While creating the design doc, what parts of your other documents (e.g.
  requirements, hazard analysis, etc), it any, needed to be changed, and why?}\\
  The SRS was modified to remove requirements that involved recording the individual cleanliness score of a user. 
  \item \textbf{What are the limitations of your solution?  Put another way, given
  unlimited resources, what could you do to make the project better?} (LO\_ProbSolutions)\\
  Current limitations in the solution include limitations in the detection ability of the cleanliness detection algorithm. As of writing, this module is implemented using pre-trained object detection models and focuses on detecting differences in the state, leaving the users to determine whether or not the state of the room has improved or worsened. This is due to a lack of time and expertise in implementing a custom AI model for this use case. Given unlimited time and resources, a dedicated artificial intelligence and object detection model specializing in detecting "messes" would be built to reduce manual effort from the user and improve the system's accuracy.\\\\
  Another limitation of the system is its inability to enforce accountability amongst roommates. Currently, the solution provides a suite of tools for roommates to use and to keep track of information but does not provide any way of enforcing things like bill payments or chores. Given more time, the team could have implemented some point or merit tracking system that would report the landlord who isn't paying bills and keeping their property in proper order, and the landlord could provide notices to tenants and help with enforcement.
  \item \textbf{Give a brief overview of other design solutions you considered.  What
  are the benefits and trade-offs of those other designs compared with the chosen
  design?  From all the potential options, why did you select the documented design?}
  (LO\_Explores)\\
  Some alternative solutions were the creation of a mobile app over a progressive web application (PWA), the creation of our machine learning model over a pre-trained model, and having the camera system track which user modified the shared living space and keeping track of which user contributed the most to issues in shared living spaces. The first two alternatives provide the development team with more flexibility and customizability but increase development time due to the team's lack of experience building AI models and mobile apps. Ultimately, the team decided to use a pre-trained AI model and build a PWA because the deadlines in this project are firm, and being unable to deliver any product is worse than a product with less functionality. Finally, the team decided not to pursue implementing the solution, which involved tracking which users did what in the shared living situations due to concerns raised by our supervisor. These concerns included privacy concerns and accuracy concerns. Since the team is using a pre-trained AI model, we decided it would be best to not associate data with users to prevent frustrations caused by false positives/negatives (defined in the \href{https://github.com/jinalkast/room8/tree/main/docs/HazardAnalysis}{Hazard Analysis}).
\end{enumerate}


\end{document}